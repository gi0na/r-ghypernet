<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finding Significant Links with gHypEGs • ghypernet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Finding Significant Links with gHypEGs">
<meta property="og:description" content="ghypernet">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ghypernet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Significantlinks.html">Finding Significant Links with gHypEGs</a>
    </li>
    <li>
      <a href="../articles/Tutorial_NRM.html">An introduction to generalized hypergeometric ensembles (gHypEG) regressions.</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">ghypernet Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Significantlinks_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Finding Significant Links with gHypEGs</h1>
                        <h4 class="author">Giona CasiraghI</h4>
            
            <h4 class="date">20/4/2018</h4>
      
      
      <div class="hidden name"><code>Significantlinks.Rmd</code></div>

    </div>

    
    
<p>In this short tutorial we exploit the ghypernet package to detect significant links. We use the Karate Club as running example.</p>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load Packages</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ghypernet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"adj_karate"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"vertexlabels"</span>)
<span class="no">karate</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span>(<span class="kw">adjmatrix</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">mode</span><span class="kw">=</span><span class="st">'undirected'</span>, <span class="kw">weighted</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">karate</span>)$<span class="no">color</span> <span class="kw">&lt;-</span> <span class="no">vertexlabels</span></pre></body></html></div>
</div>
<div id="estimate-the-ensemble" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-the-ensemble" class="anchor"></a>Estimate the ensemble</h3>
<p>First we estimate a soft-configuration model from the data. The second model is a block model based on the two ‘factions’ of members of the club</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/scm.html">scm</a></span>(<span class="no">adj_karate</span>,<span class="kw">directed</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">F</span>)

<span class="no">blockModel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/bccm.html">bccm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">vertexlabels</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">homophily</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
</div>
<div id="finding-the-significance-of-the-links" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-the-significance-of-the-links" class="anchor"></a>Finding the significance of the links</h2>
<p>We use the built-in function in the ghypernet package to compute the significance of each link as described in Casiraghi et al. 2017. The function takes the adjacency matrix of the network and the model from which estimating the probability to observe as many edges as those in the graph. We can obtain a high-pass noise filtering choosing a significance level and filtering those links which have a low significance.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># obtain significance matrix</span>
<span class="no">signmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/linkSignificance.html">linkSignificance</a></span>(<span class="no">adj_karate</span>, <span class="no">mod</span>, <span class="kw">under</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="co"># filter adjacency matrix</span>
<span class="no">adjfiltered</span> <span class="kw">&lt;-</span> <span class="no">adj_karate</span>
<span class="no">adjfiltered</span>[<span class="no">signmat</span><span class="kw">&gt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>)] <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">adjfiltered</span>[<span class="no">signmat</span><span class="kw">&lt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>) <span class="kw">&amp;</span> <span class="no">adj_karate</span><span class="kw">==</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">adjfiltered</span>) <span class="kw">&lt;-</span> <span class="fl">0</span></pre></body></html></div>
<div id="plot-the-results" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-results" class="anchor"></a>Plot the results</h3>
<p>We plot the original graph first, then a graph were the non-significant links are coloured red. The final plot only shows the significant links.</p>
<p>Note that the configuration model is not able to predict the strong links within the groups, as those go beyond simple degree effects. The results reflect this showing the two factions separated and only the links due to homophily effect left.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">adjcolor</span> <span class="kw">&lt;-</span> <span class="no">adj_karate</span>
<span class="no">adjcolor</span>[<span class="no">adj_karate</span><span class="kw">&gt;</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">adjcolor</span>[<span class="no">signmat</span><span class="kw">&lt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>)] <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">adjcolor</span>) <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">gfiltered</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span>(<span class="no">adjfiltered</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'upper'</span>)
<span class="no">g</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span>(<span class="no">adjcolor</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'upper'</span>, <span class="kw">weighted</span> <span class="kw">=</span> <span class="st">'color'</span>)
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span>[<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span><span class="kw">==</span><span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="st">"red"</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span>[<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span><span class="kw">==</span><span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="st">"black"</span>

<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">gfiltered</span>)$<span class="no">color</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">g</span>)$<span class="no">color</span> <span class="kw">&lt;-</span> <span class="no">vertexlabels</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">karate</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">g</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">gfiltered</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
</div>
</div>
<div id="block-model" class="section level2">
<h2 class="hasAnchor">
<a href="#block-model" class="anchor"></a>Block Model</h2>
<p>As the Karate Club consists of two factions, we can refine the model adding the block structure to it. Then we can filter out the links that are not significant according to this more complex model.</p>
<p>What we expect in this case is that most of the within-group links are now not significant anymore, as they can be explained by the joint effect of configuration model and block model. Hence the links that remains after filtering are those that go beyond this joint effect. In particular, only few nodes of a group interact with the other group, i.e. the between-groups links are concentrated between few dyads. From the model instead we should expect most nodes of a group weakly interacting with the other group. Hence, we can expect that the significant links will be mainly those between groups. The results are in accordance with our intuition.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">signmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/linkSignificance.html">linkSignificance</a></span>(<span class="no">adj_karate</span>, <span class="no">blockModel</span>, <span class="kw">under</span><span class="kw">=</span><span class="fl">FALSE</span>)

<span class="co"># filter adjacency matrix</span>
<span class="no">adjfiltered</span> <span class="kw">&lt;-</span> <span class="no">adj_karate</span>
<span class="no">adjfiltered</span>[<span class="no">signmat</span><span class="kw">&gt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>)] <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">adjfiltered</span>[<span class="no">signmat</span><span class="kw">&lt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>) <span class="kw">&amp;</span> <span class="no">adj_karate</span><span class="kw">==</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">adjfiltered</span>) <span class="kw">&lt;-</span> <span class="fl">0</span></pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">adjcolor</span> <span class="kw">&lt;-</span> <span class="no">adj_karate</span>
<span class="no">adjcolor</span>[<span class="no">adj_karate</span><span class="kw">&gt;</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">adjcolor</span>[<span class="no">signmat</span><span class="kw">&lt;</span>(<span class="fl">1</span>/<span class="no">mod</span>$<span class="no">m</span>)] <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">adjcolor</span>) <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">gfiltered</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span>(<span class="no">adjfiltered</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'upper'</span>)
<span class="no">g</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span>(<span class="no">adjcolor</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'upper'</span>, <span class="kw">weighted</span> <span class="kw">=</span> <span class="st">'color'</span>)
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span>[<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span><span class="kw">==</span><span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="st">"red"</span>
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span>[<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">g</span>)$<span class="no">color</span><span class="kw">==</span><span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="st">"black"</span>

<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">gfiltered</span>)$<span class="no">color</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">g</span>)$<span class="no">color</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">karate</span>)$<span class="no">color</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">karate</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">g</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">gfiltered</span>)</pre></body></html></div>
<p><img src="Significantlinks_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giona Casiraghi, Vahan Nanumyan, Laurence Brandenberger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
