<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ghypernet Tutorial • ghypernet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ghypernet Tutorial">
<meta property="og:description" content="ghypernet">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ghypernet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Significantlinks.html">Finding Significant Links with gHypEGs</a>
    </li>
    <li>
      <a href="../articles/Tutorial_NRM.html">An introduction to generalized hypergeometric ensembles (gHypEG) regressions.</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">ghypernet Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tutorial_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ghypernet Tutorial</h1>
                        <h4 class="author">Giona Casiraghi</h4>
            
            <h4 class="date">2020-10-22</h4>
      
      
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<p>This is a short tutorial to show how to employ the <code>ghypernet</code> R package for the estimation of gHypEG. In the following, we use Zachary’s Karate Club dataset as baseline. The data is provided within this package and can be simply loaded. It corresponds to a weighted adjacency matrix whose entries report the number of interactions between individuals. The graph specified by the adjacency matrix is <em>undirected</em> and does not have <em>self-loops</em>. For this reason, we specify the two parameters <code>directed=FALSE</code> and <code>selfloops=FALSE</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ghypernet</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"adj_karate"</span>)
<span class="no">directed</span> <span class="kw">&lt;-</span> <span class="fl">FALSE</span>
<span class="no">selfloops</span> <span class="kw">&lt;-</span> <span class="fl">FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">adj_karate</span>[<span class="fl">1</span>:<span class="fl">10</span>,<span class="fl">1</span>:<span class="fl">10</span>])
<span class="co">#&gt;          Mr Hi Actor 2 Actor 3 Actor 4 Actor 5 Actor 6 Actor 7 Actor 8 Actor 9</span>
<span class="co">#&gt; Mr Hi        0       4       5       3       3       3       3       2       2</span>
<span class="co">#&gt; Actor 2      4       0       6       3       0       0       0       4       0</span>
<span class="co">#&gt; Actor 3      5       6       0       3       0       0       0       4       5</span>
<span class="co">#&gt; Actor 4      3       3       3       0       0       0       0       3       0</span>
<span class="co">#&gt; Actor 5      3       0       0       0       0       0       2       0       0</span>
<span class="co">#&gt; Actor 6      3       0       0       0       0       0       5       0       0</span>
<span class="co">#&gt; Actor 7      3       0       0       0       2       5       0       0       0</span>
<span class="co">#&gt; Actor 8      2       4       4       3       0       0       0       0       0</span>
<span class="co">#&gt; Actor 9      2       0       5       0       0       0       0       0       0</span>
<span class="co">#&gt; Actor 10     0       0       1       0       0       0       0       0       0</span>
<span class="co">#&gt;          Actor 10</span>
<span class="co">#&gt; Mr Hi           0</span>
<span class="co">#&gt; Actor 2         0</span>
<span class="co">#&gt; Actor 3         1</span>
<span class="co">#&gt; Actor 4         0</span>
<span class="co">#&gt; Actor 5         0</span>
<span class="co">#&gt; Actor 6         0</span>
<span class="co">#&gt; Actor 7         0</span>
<span class="co">#&gt; Actor 8         0</span>
<span class="co">#&gt; Actor 9         0</span>
<span class="co">#&gt; Actor 10        0</span></pre></body></html></div>
<div id="fitting-a-ghypeg-model" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-a-ghypeg-model" class="anchor"></a>Fitting a gHypEG Model</h1>
<p>GHypEG Models can be fitted using the general function <code>ghype</code>. However, we provide some default functions to fit specific models. These functions take an adjacency matrix (not sparse) as main argument, or an <code>igraph</code> graph object. They further allow to specify whether the model should be directed or not, and whether it should have selfloops or not.</p>
<p>The function <code>regularm</code> allows to fit the simplest possible model that can be formulated with gHypEGs: gnp-like graph where only the average degree is preserved.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">(<span class="no">regularmodel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/regularm.html">regularm</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>))
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ghype.matrix(graph = graph, directed = directed, selfloops = selfloops, </span>
<span class="co">#&gt;     unbiased = TRUE, regular = TRUE)</span>
<span class="co">#&gt; ghype undirected , no selfloops </span>
<span class="co">#&gt; 34 vertices, 231 edges </span>
<span class="co">#&gt; Loglikelihood:</span>
<span class="co">#&gt; -584.7139</span>
<span class="co">#&gt; df: 1</span></pre></body></html></div>
<p>The function <code>scm</code> allows to fit the soft-configuration model, where all degrees are preserved.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">(<span class="no">confmodel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/scm.html">scm</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>))
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ghype.matrix(graph = graph, directed = directed, selfloops = selfloops, </span>
<span class="co">#&gt;     unbiased = TRUE, regular = FALSE)</span>
<span class="co">#&gt; ghype undirected , no selfloops </span>
<span class="co">#&gt; 34 vertices, 231 edges </span>
<span class="co">#&gt; Loglikelihood:</span>
<span class="co">#&gt; -434.5449</span>
<span class="co">#&gt; df: 34</span></pre></body></html></div>
<p>From the models, we can generate random realisations that can be used, e.g., as null-models to test hypothesis about the data. This can be achieved by means of the function <code>rghype</code>, specifying the number of realisations to take.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">random_graphs_rm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rghype.html">rghype</a></span>(<span class="kw">nsamples</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">regularmodel</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="no">random_graphs_scm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rghype.html">rghype</a></span>(<span class="kw">nsamples</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">confmodel</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)</pre></body></html></div>
<p>Finally, we can perform model selection and hypothesis testing by comparing statistics of two models. We can follow two different approaches, comparing information scores such as AIC, or performing a likelihood ratio test. One simple question we can ask, for example, is whether the degree sequence of the Karate Club can be simply explained by a regular model, or there is the need to use a configuration model. AIC scores can be obtained using the standard R function <code>AIC</code>. Likelihood-ratio tests are performed using the function <code>lr.test</code>. However, we provide some wrappers for the function <code>lr.test</code> for some commonly done tests like the one above.</p>
<p>Comparing AIC scores for the regular model and the configuration model yields the following result:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">regularmodel</span>)
<span class="co">#&gt; [1] 1171.428</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">confmodel</span>)
<span class="co">#&gt; [1] 937.0897</span>

<span class="co"># difference in AICs, high value means more complex model is better</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">regularmodel</span>) - <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">confmodel</span>)
<span class="co">#&gt; [1] 234.338</span></pre></body></html></div>
<p>This shows that the there is strong evidence for the employing the configuration model, because the degree sequence of the graph strongly deviates from the regular one.</p>
<p>To increase confidence in this result, we can compare the result above with that obtained from random data generated from the regular model.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># Generate regular models and configuration models for random graphs</span>
<span class="no">regularmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">random_graphs_rm</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">regularm</span>, <span class="kw">directed</span><span class="kw">=</span><span class="no">directed</span>, <span class="kw">selfloops</span><span class="kw">=</span><span class="no">selfloops</span>)
<span class="no">confmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">random_graphs_rm</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">scm</span>, <span class="kw">directed</span><span class="kw">=</span><span class="no">directed</span>, <span class="kw">selfloops</span><span class="kw">=</span><span class="no">selfloops</span>)
<span class="co"># Compute AICs</span>
<span class="no">AIC_regularmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">regularmodels</span>,<span class="kw">FUN</span> <span class="kw">=</span> <span class="no">AIC</span>)
<span class="no">AIC_confmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">confmodels</span>,<span class="kw">FUN</span> <span class="kw">=</span> <span class="no">AIC</span>)
<span class="co"># differences in AIC, high value means more complex model is better</span>
<span class="no">AIC_regularmodels</span> - <span class="no">AIC_confmodels</span>
<span class="co">#&gt;  [1] -46.55258 -32.36789 -20.92125 -28.61791 -34.33781 -39.78901 -31.21541</span>
<span class="co">#&gt;  [8] -30.15379 -18.92063 -41.49301</span></pre></body></html></div>
<p>As can be seen by the experiment above, in the case of random graphs generated from the regular model, the AIC of the configuration model is <em>higher</em> than that of the regular model, confirming that the added complexity is not justified.</p>
<p>The (empirical) likelihood-ratio test gives a similar result, with the benefit of providing a p-value. The function <code>conf.test</code> provides a simple way to perform the test without the need of computing the models.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/conf.test.html">conf.test</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>, <span class="kw">seed</span><span class="kw">=</span><span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test -- gnp vs CM</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 299.79, df = 33, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  19.63033 51.83806</span></pre></body></html></div>
<p>Similarly to what done above, we can perform the test using the random graphs. Now we expect large p-values.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">tests</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">random_graphs_rm</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">conf.test</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>, <span class="kw">seed</span><span class="kw">=</span><span class="fl">123</span>)
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">tests</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="no">p.value</span>)
<span class="co">#&gt;  [1] 0.97652855 0.47749983 0.09433827 0.30929582 0.57422868 0.82213540</span>
<span class="co">#&gt;  [7] 0.42243781 0.37426112 0.06527072 0.87972711</span></pre></body></html></div>
</div>
<div id="block-constrained-configuration-model" class="section level1">
<h1 class="hasAnchor">
<a href="#block-constrained-configuration-model" class="anchor"></a>Block-Constrained Configuration Model</h1>
<p>The next model that can be estimated is the block constrained configuration model. The Karate Club has a well-known partitioning into two communities that can be loaded from the package. We fit a bccm using the <code>bccm</code> function, specifying the vertex labels.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"vertexlabels"</span>)
(<span class="no">blockmodel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/bccm.html">bccm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">vertexlabels</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>))
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; bccm(adj = adj_karate, labels = vertexlabels, directed = directed, </span>
<span class="co">#&gt;     selfloops = selfloops)</span>
<span class="co">#&gt; block ghype undirected , no selfloops </span>
<span class="co">#&gt; 34 vertices, 231 edges </span>
<span class="co">#&gt; Loglikelihood:</span>
<span class="co">#&gt; -336.8385</span>
<span class="co">#&gt; df: 36 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;     Estimate    Std.Err t value    Pr(&gt;t)    </span>
<span class="co">#&gt; 1 1.00000000 0.00000000     Inf &lt; 2.2e-16 ***</span>
<span class="co">#&gt; 2 0.09044494 0.00021692  416.95 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; 4 0.91049902 0.00040434 2251.79 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">blockmodel</span>$<span class="no">blockOmega</span>)
<span class="co">#&gt;            1          2</span>
<span class="co">#&gt; 1 1.00000000 0.09044494</span>
<span class="co">#&gt; 2 0.09044494 0.91049902</span></pre></body></html></div>
<p>By default, the function fits a ‘full’ block structure, where every parameter for in- out-blocks relations are different. In this case this corresponds to three parameters: one for block 1, one for block 2, one for the edges between the two blocks. However, in some cases we see that the parameters of in-blocks relations are similar to each other, as can be seen above looking at the diagonal entries of the block matrix. In this case, a full block structure may overfit the data, while a simpler model could be better. This can be fitted setting the parameter <code>homophily=TRUE</code>. This corresponds to a model where there are only two parameters, one for in-block edges, one for out-block edges, irrespectively of the number of blocks. The result is shown below.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">(<span class="no">blockmodel_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/bccm.html">bccm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">vertexlabels</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>, <span class="kw">homophily</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; bccm(adj = adj_karate, labels = vertexlabels, directed = directed, </span>
<span class="co">#&gt;     selfloops = selfloops, homophily = TRUE)</span>
<span class="co">#&gt; block ghype undirected , no selfloops </span>
<span class="co">#&gt; 34 vertices, 231 edges </span>
<span class="co">#&gt; Loglikelihood:</span>
<span class="co">#&gt; -337.0666</span>
<span class="co">#&gt; df: 35 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;     Estimate    Std.Err t value    Pr(&gt;t)    </span>
<span class="co">#&gt; 1 1.00000000 0.00000000     Inf &lt; 2.2e-16 ***</span>
<span class="co">#&gt; 2 0.09512422 0.00020628  461.14 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></body></html></div>
<p>The first test we need to perform is whether either of the model just fitted significantly improve the fit to the data. We do so by performing a likelihood ratio test between the configuration model and the bccms.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/lr.test.html">lr.test</a></span>(<span class="kw">nullmodel</span> <span class="kw">=</span> <span class="no">confmodel</span>, <span class="kw">altmodel</span> <span class="kw">=</span> <span class="no">blockmodel</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 195.41, df = 2, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  1.306644e-08 8.230181e+00</span>
<span class="fu"><a href="../reference/lr.test.html">lr.test</a></span>(<span class="kw">nullmodel</span> <span class="kw">=</span> <span class="no">confmodel</span>, <span class="kw">altmodel</span> <span class="kw">=</span> <span class="no">blockmodel_2</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 194.96, df = 1, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  1.474561e-08 8.031860e+00</span></pre></body></html></div>
<p>Unsurprisingly, the test gives low p-values, confirming the presence of a block structure. Again, we can perform a similar analysis using AIC:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">confmodel</span>)
<span class="co">#&gt; [1] 937.0897</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">blockmodel_2</span>)
<span class="co">#&gt; [1] 744.1332</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="no">blockmodel</span>)
<span class="co">#&gt; [1] 745.677</span></pre></body></html></div>
<p>From this, we note that while specifying the full bccm gives an improvement in the score compared to the two parameters model, such improvement is relatively small, and appears to not justify the increased complexity. We can verify again this with a likelihood-ratio test:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/lr.test.html">lr.test</a></span>(<span class="kw">nullmodel</span> <span class="kw">=</span> <span class="no">blockmodel_2</span>, <span class="kw">altmodel</span> <span class="kw">=</span> <span class="no">blockmodel</span>, <span class="kw">seed</span><span class="kw">=</span><span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 0.45622, df = 1, p-value = 0.7645</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.03722328 6.94467855</span></pre></body></html></div>
<p>The result shows that the added complexity of the second model is not justified by the data. We investigate this further by comparing the results with what obtained from random variations.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># First generate random sample from blockmodel</span>
<span class="no">random_graphs_bccm2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rghype.html">rghype</a></span>(<span class="kw">nsamples</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">blockmodel_2</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="co"># Generate the two models for random graphs</span>
<span class="no">blockmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">random_graphs_bccm2</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">bccm</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">vertexlabels</span>, <span class="kw">directed</span><span class="kw">=</span><span class="no">directed</span>, <span class="kw">selfloops</span><span class="kw">=</span><span class="no">selfloops</span>)
<span class="no">blockmodel_2s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">random_graphs_bccm2</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">bccm</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">vertexlabels</span>, <span class="kw">directed</span><span class="kw">=</span><span class="no">directed</span>, <span class="kw">selfloops</span><span class="kw">=</span><span class="no">selfloops</span>, <span class="kw">homophily</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co"># Compute AICs</span>
<span class="no">AIC_blockmodels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">blockmodels</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">AIC</span>)
<span class="no">AIC_blockmodel_2s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">blockmodel_2s</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">AIC</span>)
<span class="co"># mean difference in AIC, high value means more complex model is better</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">AIC_blockmodel_2s</span> - <span class="no">AIC_blockmodels</span>)
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt; -2.0000 -1.5366 -0.6637 -0.1704  0.6268  8.3348</span></pre></body></html></div>
<p>This confirms the fact that the asymmetry in the two blocks can ascribed to random variations.</p>
</div>
<div id="goodness-of-fit" class="section level1">
<h1 class="hasAnchor">
<a href="#goodness-of-fit" class="anchor"></a>Goodness of Fit</h1>
<p>Finally, our framework allows to evaluate the goodness-of-fit of model to data. Similarly to a multinomial goodness-of-fit, we perform a test of the chosen against the <em>maximally complex model</em> that can be formulated. This model provides the baseline against which comparing simpler models in terms of their goodness-of-fit. The ‘full model’ is specified such that the observed graph is the expected one. It is fitted using the function <code>ghype</code> with the flag <code>unbiased=FALSE</code>. The likelihood ratio test can be performed either manually or using the function <code>gof.test</code>.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">fullmodel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ghype.html">ghype</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">adj_karate</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="no">directed</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="no">selfloops</span>, <span class="kw">unbiased</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="fu"><a href="../reference/lr.test.html">lr.test</a></span>(<span class="kw">nullmodel</span> <span class="kw">=</span> <span class="no">blockmodel_2</span>, <span class="kw">altmodel</span> <span class="kw">=</span> <span class="no">fullmodel</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 454.89, df = 559, p-value = 7.719e-14</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  270.4443 340.7790</span>
<span class="fu"><a href="../reference/gof.test.html">gof.test</a></span>(<span class="kw">model</span> <span class="kw">=</span> <span class="no">blockmodel_2</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  LR test -- GOF</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; lr = 454.89, df = 559, p-value = 7.719e-14</span>
<span class="co">#&gt; alternative hypothesis: one.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  270.4443 340.7790</span></pre></body></html></div>
<p>The reason for this result is the fact that, although the bccm is a good fit for the empirical graph, the latter is characterised by some particular structures that are not encoded by the bccm. For example, the empirical graph is characterised by few ‘bridges’ between the two communities, managed by relatively low degree vertices. Instead, the bccm assumes that <em>all</em> vertices connect weakly the two communities, with an amount of edges proportional to the degree.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giona Casiraghi, Vahan Nanumyan, Laurence Brandenberger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
