<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to generalized hypergeometric ensembles (gHypEG) regressions. • ghypernet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to generalized hypergeometric ensembles (gHypEG) regressions.">
<meta property="og:description" content="ghypernet">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ghypernet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Significantlinks.html">Finding Significant Links with gHypEGs</a>
    </li>
    <li>
      <a href="../articles/Tutorial_NRM.html">An introduction to generalized hypergeometric ensembles (gHypEG) regressions.</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">ghypernet Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Tutorial_NRM_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An introduction to generalized hypergeometric ensembles (gHypEG) regressions.</h1>
                        <h4 class="author">Giona Casiraghi</h4>
            <address class="author_afil">
      Chair of Systems Design, ETH Zurich, Switzerland<br><a class="author_email" href="mailto:#"></a><a href="mailto:gcasiraghi@ethz.ch" class="email">gcasiraghi@ethz.ch</a>
      </address>
                              <h4 class="author">Laurence Brandenberger</h4>
            <address class="author_afil">
      Chair of Systems Design, ETH Zurich, Switzerland<br><a class="author_email" href="mailto:#"></a><a href="mailto:lbrandenberger@ethz.ch" class="email">lbrandenberger@ethz.ch</a>
      </address>
                  
            <h4 class="date">2020-10-21</h4>
      
      
      <div class="hidden name"><code>Tutorial_NRM.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The Package  is used to run inferential models on multi-edge networks. This vignette guides through the data preparation and model estimation and assessment steps needed to perform network regressions on multi-edge networks. This vignette is split into 3 distinct parts</p>
<ol style="list-style-type: decimal">
<li>Part 1: Data preparation</li>
<li>Part 2: Running gHypEG regressions</li>
<li>Part 3: Model assessment, simulations and goodness-of-fit</li>
</ol>
<p>The vignette builds on a multi-edge network of Swiss members of Parliament. The data set is contained in the package for easy loading. The data set records co-sponsorship activities of 163 members of the Swiss National Council (in German: Natioanlrat). Whenever a member of parliament (MP) drafts a new legislation (or bill), poses a question to the Federal Council (in German: Bundesrat), issues a motion or petition, they are allowed to add co-signatories (or co-sponsors) to the proposal. These co-sponsorship signatures act as a measure of support and signals the relevance of the proposal. As MPs can submit multiple proposals during the course of their service in parliament, each MP can support another MP multiple times, resulting in a multi-edge network of support among MPs.</p>
<!-- # gHypEG -->
<!-- ## math basis -->
<!-- ## build up of models -->
<!-- ## using gHypEG for regressions: gHypEG nrm -->
<!-- ## - the model: introduction (math) -->
<!-- ## - independent variables: endogenous, exogenous (layers) (math) -->
<!-- ## - estimation (math) -->
</div>
<div id="part-1-data-preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#part-1-data-preparation" class="anchor"></a>Part 1: Data preparation</h1>
<div id="loading-package-and-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-package-and-data" class="anchor"></a>Loading package and data</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ghypernet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">texreg</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># for regression tables</span>
<span class="co">#&gt; Version:  1.37.5</span>
<span class="co">#&gt; Date:     2020-06-17</span>
<span class="co">#&gt; Author:   Philip Leifeld (University of Essex)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Consider submitting praise using the praise or praise_interactive functions.</span>
<span class="co">#&gt; Please cite the JSS article in your publications -- see citation("texreg").</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>) <span class="co"># for plotting</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggraph</span>) <span class="co">#for network plots using ggplot2</span></pre></body></html></div>
<p>After loading the  package, the included data set on Swiss MPs can be used (already lazy loaded).</p>
<!-- ## Cosponsorship data -->
<!-- #- cosponsorship matrix  -->
<!-- #- online support similarity (jaccard matrix) -->
<!-- #- attribute list (party, parliamentary group, gender, age) -->
<!-- #- committee list -->
<p>The data set contains four objects:</p>
<ol style="list-style-type: decimal">
<li>
<strong>cospons_mat</strong>: contains the adjacency matrix of 163 x 163 MPs. It contains the number of times one MP (rows) supports the submitted proposals of another MP (columns).</li>
<li>
<strong>dt</strong>: contains different attributes of the 163 MPs, such as their names, their party affiliation (variable: <em>party</em>), their parliamentary group affiliation (variable: <em>parlGroup</em>), the Canton (or state) they represent (variable: <em>canton</em>), their gender (variable: <em>gender</em>) and date of birth (variable: <em>birthdate</em>).</li>
<li>
<strong>dtcommittee</strong>: a list of committees each MP was part of during their stay in parliament</li>
<li>
<strong>onlinesim_mat</strong>: a similarity matrix of how similar two MPs are in their online social media presence (shared supportees).</li>
</ol>
</div>
<div id="network-data-manipulations" class="section level2">
<h2 class="hasAnchor">
<a href="#network-data-manipulations" class="anchor"></a>Network data manipulations</h2>
<p>The above data is coded in an adjacency matrix. However, most often, network data is stored in the more efficient edge list format. Two functions help move from one format to another:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">el</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/adj2el.html">adj2el</a></span>(<span class="no">cospons_mat</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>The <code><a href="../reference/adj2el.html">adj2el()</a></code>-function transforms an adjacency matrix into an edgelist. By specifying <code>directed = FALSE</code>, only the top triangle of the adjacency matrix is stored in the edgelist (making it more efficient to handle, especially for large networks).</p>
<p>Edgelists also allow you to check basic statics about your network, such as average degree or the degree distribution.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">el</span>$<span class="no">edgecount</span>)
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   1.000   1.000   2.000   3.854   4.000  75.000</span></pre></body></html></div>
<p>The function <code>el2adj</code> transforms an edgelist into an adjacency matrix.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">nodes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">cospons_mat</span>)
<span class="no">adj_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/el2adj.html">el2adj</a></span>(<span class="no">el</span>, <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">nodes</span>)</pre></body></html></div>
<p>Since edgelists (often) do not store isolate nodes in the network, the function takes a <code>nodes</code>-attribute. By specifying the nodes attribute, all all nodes (including isolate nodes) are included in the adjacency matrix.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="no">cospons_mat</span>, <span class="no">adj_mat</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
</div>
<div id="compiling-nodal-attribute-data" class="section level2">
<h2 class="hasAnchor">
<a href="#compiling-nodal-attribute-data" class="anchor"></a>Compiling nodal attribute data</h2>
<!-- This can be shortened for the vignette. 
It's good to have it in the tutorial though, I think. -->
<p>When preparing nodal attribute data, particular attention has to be given to the ordering of the two data sets (the adjacancy matrix and the attribute data set). Testing whether the adjacency matrix and the attribute data are ordered by the same identifiers (here by the ID codes of the individual MPs, <code>dt$idMP</code>), attribute-based independent and control variables will correspond with the dependent variable.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>), <span class="no">dt</span>$<span class="no">idMP</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>In case, the above test-code yields <code>FALSE</code>, the attribute data needs to be ordered.</p>
<p>Let’s assume, our attribute data set <code>dt_unsorted</code> is sorted differently:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">dt_unsorted</span> <span class="kw">&lt;-</span> <span class="no">dt</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">dt</span>$<span class="no">firstName</span>),]
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>), <span class="no">dt_unsorted</span>$<span class="no">idMP</span>)
<span class="co">#&gt; [1] FALSE</span></pre></body></html></div>
<p>The simplest way is to proceed is to create a new data frame with the rownames (or colnames) of the adjacency matrix, then merging the attribute data in.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">dtsorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">idMP</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>))
<span class="no">dtsorted</span> <span class="kw">&lt;-</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">dtsorted</span>, <span class="no">dt_unsorted</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"idMP"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="no">dt</span>$<span class="no">idMP</span>, <span class="no">dtsorted</span>$<span class="no">idMP</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>Learn more about data joins <a href="https://www.r-bloggers.com/2018/10/how-to-perform-merges-joins-on-two-or-more-data-frames-with-base-r-tidyverse-and-data-table/">here</a>.</p>
</div>
<div id="independent-and-control-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#independent-and-control-variables" class="anchor"></a>Independent and control variables</h2>
<p>To estimate effects of endogenous and exogenous factors (i.e., independent and control variables) on the multi-edge network, covariates have to be fed into the gHypEG regression as matrices with the same dimensions as the multi-edge network (i.e., the dependent variable).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">cospons_mat</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">onlinesim_mat</span>)
<span class="co">#&gt; [1] TRUE TRUE</span></pre></body></html></div>
<p>Additionally, it is prudent to make sure that all covariates have the same row- and column-names:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">onlinesim_mat</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; TRUE </span>
<span class="co">#&gt;  163</span></pre></body></html></div>
<div id="the-role-of-zero-values-in-covariates" class="section level3">
<h3 class="hasAnchor">
<a href="#the-role-of-zero-values-in-covariates" class="anchor"></a>The role of zero-values in covariates</h3>
<p>The gHypEG regression is zero-sensitive. Zero value entries in covariates signify structural zeros and are not considered in the estimation process. Therefore, all zero-values that do not signify structural zeros need to be recoded. To simplify interpretation of coefficient sizes in the regression, a minimum value divided by a factor of 10 is the simplest substitution.</p>
<p>For instance, if a dummy variable takes 0, 1 values in a matrix, all 0 values should be recoded to 0.1. If endogenous network statics are calculated, these zero-values are automatically generated (see below).</p>
</div>
<div id="change-statistics-to-calculate-endogenous-network-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#change-statistics-to-calculate-endogenous-network-statistics" class="anchor"></a>Change statistics to calculate endogenous network statistics</h3>
<!-- we move this up to the methods section of the jss-vignette later on. needs to be -->
<!-- expanded. -->
<p>Change statistics (or change scores) can be used to model endogenous network properties in inferential network models <span class="citation">[@snijders2006new, @hunter2008goodness, @krivitsky2011adjusting]</span>. For each dyad in the multi-edge network, the change statistic caputres the (un-)weighted values of additional edges involved in the interested network pattern. See Brandenberger et al. <span class="citation">[-@brandenberger2019quantifying]</span> for additional information on change statistics for multi-edge networks.</p>
</div>
<div id="reciprocity" class="section level3">
<h3 class="hasAnchor">
<a href="#reciprocity" class="anchor"></a>Reciprocity</h3>
<p>The <code><a href="../reference/reciprocity_stat.html">reciprocity_stat()</a></code>-function can be used to calculate weighted reciprocity change statistic. Since it’s dyad-independent, it can be used as a predictor in the gHypEG regression.</p>
<p>The function takes either a matrix or an edgelist. If an edgelist is provided, the <code>nodes</code>-object can be specified again to ensure that isolates are included as well.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">recip_cospons</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/reciprocity_stat.html">reciprocity_stat</a></span>(<span class="no">cospons_mat</span>)
<span class="no">recip_cospons</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">3</span>]
<span class="co">#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter</span>
<span class="co">#&gt; Andreas Broennimann                 0.1         0.1           0.1</span>
<span class="co">#&gt; Ueli Maurer                         0.1         0.1           0.1</span>
<span class="co">#&gt; Markus Hutter                       2.0         1.0           0.1</span>
<span class="co">#&gt; Hansruedi Wandfluh                  0.1         1.0           0.1</span>
<span class="co">#&gt; Thomas Matter                       0.1         0.1           0.1</span></pre></body></html></div>
<p>The resultant matrix measures reciprocity by checking for each dyad <span class="math inline">\((i, j)\)</span>, how many edges were drawn from <span class="math inline">\((j, i)\)</span>. If reciprocity is a driving force in the network, taking the transpose of the matrix should correlate strongly with the co-sponsorship matrix.</p>
<p>The <code>zero_values</code>-argument allows for the specification of minimum values. By default, the minimum edgecount in the network divided by a factor of 10 is used (here 1/10 = .1). This simplifyies interpretation of coefficient sizes.</p>
</div>
<div id="triadic-closure" class="section level3">
<h3 class="hasAnchor">
<a href="#triadic-closure" class="anchor"></a>Triadic closure</h3>
<p>The <code><a href="../reference/sharedPartner_stat.html">sharedPartner_stat()</a></code>-function provides change statistics to check your multi-edge network for meaningful triadic closure effects. Triadic closure refers to the important tendency observed in social networks to form triangles, or triads, between three nodes <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span> and <span class="math inline">\(i\)</span>. If dyad <span class="math inline">\((i, k)\)</span> are connected, and dyad <span class="math inline">\((j, k)\)</span> are connected, there is a strong tendency in some social networks that dyad <span class="math inline">\((i, j)\)</span> also shares an edge (see Figure 1a and 1b).</p>
<p>The <code><a href="../reference/sharedPartner_stat.html">sharedPartner_stat()</a></code>-function uses the concept of shared partner statistics to calculate the tendencies of nodes in multi-edge networks to re-inforce triangular structures (see Figure 1c).</p>
<div class="figure" style="text-align: center">
<img src="images/tikz_nweffects.pdf" alt="Figure 1: Triadic closure: (a) undirected triangle, (b) transitive triplet, (c) edge-wise shared partners. Source: Brandenberger et al. [-@brandenberger2019quantifying]." width="100%"><p class="caption">
Figure 1: Triadic closure: (a) undirected triangle, (b) transitive triplet, (c) edge-wise shared partners. Source: Brandenberger et al. <span class="citation">[-@brandenberger2019quantifying]</span>.
</p>
</div>
<p>For undirected multi-edge networks, the statistic measures for each dyad <span class="math inline">\((i, j)\)</span>—regardless of whether or not <span class="math inline">\((i, j)\)</span> share edges or not—how many shared partners <span class="math inline">\(k\)</span> both nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> have in common.</p>
<p>If the option <code>weighted = FALSE</code> is specified, the raw number of shared partners <span class="math inline">\(k\)</span> is reported in the shared partner matrix. For dense multi-edge networks, this statistic is not meaningful enough (since all dyads share at least one edge in a complete graph) to examine meaningful triadic closure. The option <code>weighted = TRUE</code> therefore calculates a weighted shared partner statistic, where edge counts are taken into consideration as well (min(edgecount(i, k), edgecount(j, k))) <span class="citation">[see @brandenberger2019quantifying]</span>.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">shp_cospons_unweighted &lt;- sharedPartner_stat(cospons_mat, directed = TRUE, weighted = FALSE)
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%
shp_cospons_unweighted[1:5, 1:3]
#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter
#&gt; Andreas Broennimann                   0          13            23
#&gt; Ueli Maurer                          13           0            15
#&gt; Markus Hutter                        23          15             0
#&gt; Hansruedi Wandfluh                   24          15            45
#&gt; Thomas Matter                         0           0             1
shp_cospons_weighted &lt;- sharedPartner_stat(cospons_mat, directed = TRUE)
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%
shp_cospons_weighted[1:5, 1:3]
#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter
#&gt; Andreas Broennimann                   0          19            74
#&gt; Ueli Maurer                          19           0            19
#&gt; Markus Hutter                        74          19             0
#&gt; Hansruedi Wandfluh                   79          33            96
#&gt; Thomas Matter                         0           0             1</pre></body></html></div>
<p>For directed multi-edge networks, the option <code>triad.type</code> allows for two more specialized shared partner statistics: incoming and outgoing shared partners. Assume dyad <span class="math inline">\((i, j)\)</span> have shared partner <span class="math inline">\(k\)</span> in common. For <code>triad.type = "incoming"</code>, it is assumed that <span class="math inline">\(k\)</span> ties to <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (= edges <span class="math inline">\((k, i)\)</span> and <span class="math inline">\((k, j)\)</span> are present). In the co-sponsorship example, this measures whether nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are likely to support each other, if they both are supported by the same other node/s <span class="math inline">\(k\)</span>. For <code>triad.type = "outgoing"</code>, it is assumed that <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> both tie to <span class="math inline">\(k\)</span> (regardless of whether <span class="math inline">\(k\)</span> also ties to <span class="math inline">\(i\)</span> or <span class="math inline">\(j\)</span>). In other words, for outgoing- shared partners, for dyad <span class="math inline">\((i, j)\)</span>, we check whether edges <span class="math inline">\((i, k)\)</span> and <span class="math inline">\((j, k)\)</span> are present.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">shp_cospons_incoming &lt;- sharedPartner_stat(cospons_mat, directed = TRUE,
                                          triad.type = 'directed.incoming')
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%
shp_cospons_incoming[1:5, 1:3]
#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter
#&gt; Andreas Broennimann                   0          19            29
#&gt; Ueli Maurer                          19           0            19
#&gt; Markus Hutter                        29          19             0
#&gt; Hansruedi Wandfluh                   64          33            68
#&gt; Thomas Matter                         0           0             1
shp_cospons_outgoing &lt;- sharedPartner_stat(cospons_mat, directed = TRUE,
                                          triad.type = 'directed.outgoing')
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%
shp_cospons_outgoing[1:5, 1:3]
#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter
#&gt; Andreas Broennimann                   0           0            45
#&gt; Ueli Maurer                           0           0             0
#&gt; Markus Hutter                        45           0             0
#&gt; Hansruedi Wandfluh                   15           0            28
#&gt; Thomas Matter                         0           0             0</pre></body></html></div>
</div>
<div id="homophily" class="section level3">
<h3 class="hasAnchor">
<a href="#homophily" class="anchor"></a>Homophily</h3>
<p>The <code><a href="../reference/homophily_stat.html">homophily_stat()</a></code>-function can be used to calculate homophily tendencies in the multi-edge network. Homophily represents the tendency of nodes with similar attributes to cluster together (i.e., nodes interact more with similar other nodes than dissimilar ones) <span class="citation">[see @mcpherson2001birds]</span>. The function can be used for categorical and continuous attributes.</p>
<p>If a categorical attribute is provided (in the form of a <code>character</code> or <code>factor</code> variable), <code><a href="../reference/homophily_stat.html">homophily_stat()</a></code> creates a homophily matrix, where nodes of the same attribute are set to 10 and dyads with nodes of dissimilar attributes are set 1.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">canton_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">canton</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>,
                                      <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>)
<span class="no">canton_homophilymat</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">3</span>]
<span class="co">#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter</span>
<span class="co">#&gt; Andreas Broennimann                  10           1             1</span>
<span class="co">#&gt; Ueli Maurer                           1          10            10</span>
<span class="co">#&gt; Markus Hutter                         1          10            10</span>
<span class="co">#&gt; Hansruedi Wandfluh                   10           1             1</span>
<span class="co">#&gt; Thomas Matter                         1          10            10</span></pre></body></html></div>
<p>The option <code>these.categories.only</code> can be used to specify which categories in the attribute variable should lead to a match. For instance, if you’d only like to test whether parliamentary members from the canton Bern exhibit homophily tendencies, you can specify:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">canton_BE_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">canton</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>,
                                      <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>, <span class="kw">these.categories.only</span> <span class="kw">=</span> <span class="st">'Bern'</span>)</pre></body></html></div>
<p>You can also specify multiple matches, e.g.:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">canton_BEZH_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">canton</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>,
                                      <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>,
                                      <span class="kw">these.categories.only</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Bern'</span>, <span class="st">'Zuerich'</span>))</pre></body></html></div>
<p>The matrix <code>canton_BEZH_homophilymat</code> now reports homophily values of 10 for dyads of MPs who are both from Bern or both from Zurich, compared to all other dyads (set to 1).</p>
<p>Apart from cantonal homophily, party, parliamentary groups, gender and age homophily may play a role in co-sponsorship interactions.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">party_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">party</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>, <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>)
<span class="no">parlgroup_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">parlGroup</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>, <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>)
<span class="no">gender_homophilymat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">gender</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'categorical'</span>, <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>)</pre></body></html></div>
<p>If a numeric variable is provided, the <code><a href="../reference/homophily_stat.html">homophily_stat()</a></code>-function calculates absolute differences for each dyad in the network.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">dt</span>$<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fl">2019</span> - <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">dt</span>$<span class="no">birthdate</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">'%d.%m.%Y'</span>), <span class="st">"%Y"</span>))
<span class="no">age_absdiffmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/homophily_stat.html">homophily_stat</a></span>(<span class="no">dt</span>$<span class="no">age</span>,  <span class="kw">type</span> <span class="kw">=</span> <span class="st">'absdiff'</span>, <span class="kw">nodes</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">idMP</span>)
<span class="no">age_absdiffmat</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">3</span>]
<span class="co">#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter</span>
<span class="co">#&gt; Andreas Broennimann                 0.1         5.0           2.0</span>
<span class="co">#&gt; Ueli Maurer                         5.0         0.1           7.0</span>
<span class="co">#&gt; Markus Hutter                       2.0         7.0           0.1</span>
<span class="co">#&gt; Hansruedi Wandfluh                  3.0         2.0           5.0</span>
<span class="co">#&gt; Thomas Matter                      11.0        16.0           9.0</span></pre></body></html></div>
<p>For each dyad <span class="math inline">\((i, j)\)</span>, the age of <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are subtracted and the absolute value is used in the resultant homophily matrix. It is important to note that the absolute difference statistic is slightly counter-intuitive, since small differences indicate stronger homophily. In the gHypEG regression, this presents as a negative coefficient for strong homophily tendencies.</p>
<p>The <code>zero_values</code>-option can again be used to specify your own zero-values replacements.</p>
</div>
<div id="creating-custom-covariates" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-custom-covariates" class="anchor"></a>Creating custom covariates</h3>
<p>Generally, any meaningful matrix with the same dimension as the dependent variable (i.e., here the co-sponsorship matrix) can be used as a covariate in the gHypEG regression <span class="citation">[see @casiraghi2017multiplex]</span>.</p>
<p>An example: the data frame <code>dtcommittee</code> contains information on which committees each MP served on during their time in office.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">dtcommittee</span>)
<span class="co">#&gt;                  idMP</span>
<span class="co">#&gt; 1 Andreas Broennimann</span>
<span class="co">#&gt; 2         Ueli Maurer</span>
<span class="co">#&gt; 3       Markus Hutter</span>
<span class="co">#&gt; 4  Hansruedi Wandfluh</span>
<span class="co">#&gt; 5       Thomas Matter</span>
<span class="co">#&gt; 6          Gabi Huber</span>
<span class="co">#&gt;                                                                          committee_names</span>
<span class="co">#&gt; 1                                                                    Finanzkommission NR</span>
<span class="co">#&gt; 2               Kommission fuer soziale Sicherheit und Gesundheit NR;Finanzkommission NR</span>
<span class="co">#&gt; 3                      Kommission fuer Verkehr und Fernmeldewesen NR;Finanzkommission NR</span>
<span class="co">#&gt; 4                                              Kommission fuer Wirtschaft und Abgaben NR</span>
<span class="co">#&gt; 5                                              Kommission fuer Wirtschaft und Abgaben NR</span>
<span class="co">#&gt; 6 Kommission fuer Verkehr und Fernmeldewesen NR;Kommission fuer Rechtsfragen NR;Buero NR</span></pre></body></html></div>
<p>One potential predictor for co-sponsorship support may be if two MPs shared the same committee seat. When preparing your own matrices, make sure the row- and columnnames match the depdenent variable (here the co-sponsorship matrix).</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co">## This is just one potential way of accomplishing this! </span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">dtcommittee</span>$<span class="no">idMP</span>), <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>))
<span class="co">#&gt; [1] TRUE</span>
<span class="no">shared_committee</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">shared_committee</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">cospons_mat</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">shared_committee</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">cospons_mat</span>)
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">shared_committee</span>)){
  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">shared_committee</span>)){
    <span class="no">committees_i</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">dtcommittee</span>$<span class="no">committee_names</span>[<span class="no">i</span>]), <span class="st">";"</span>))
    <span class="no">committees_j</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">dtcommittee</span>$<span class="no">committee_names</span>[<span class="no">j</span>]), <span class="st">";"</span>))
    <span class="no">shared_committee</span>[<span class="no">i</span>, <span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="no">committees_i</span>, <span class="no">committees_j</span>))
  }
}
<span class="no">shared_committee</span>[<span class="no">shared_committee</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">0.1</span> <span class="co"># replace zero-values</span>
<span class="no">shared_committee</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">3</span>]
<span class="co">#&gt;                     Andreas Broennimann Ueli Maurer Markus Hutter</span>
<span class="co">#&gt; Andreas Broennimann                 1.0         1.0           1.0</span>
<span class="co">#&gt; Ueli Maurer                         1.0         2.0           1.0</span>
<span class="co">#&gt; Markus Hutter                       1.0         1.0           2.0</span>
<span class="co">#&gt; Hansruedi Wandfluh                  0.1         0.1           0.1</span>
<span class="co">#&gt; Thomas Matter                       0.1         0.1           0.1</span></pre></body></html></div>
</div>
<div id="attribute-based-degree-measures" class="section level3">
<h3 class="hasAnchor">
<a href="#attribute-based-degree-measures" class="anchor"></a>(Attribute-based) Degree measures</h3>
<p>The gHypEG regression accounts for combinatorial effects, i.e., degree distributions. Compared to other inferential network models, it is therefore not neccessary to specify (out/in-)degree variables. The model can be estimated using average expected degrees. In this case it is wise to specify a degree control matrix:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">dt</span>$<span class="no">degree</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="no">cospons_mat</span>) + <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(<span class="no">cospons_mat</span>)
<span class="no">degreemat</span> <span class="kw">&lt;-</span> <span class="no">cospons_mat</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>)){
  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>)){
    <span class="no">degreemat</span>[<span class="no">i</span>, <span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">dt</span>$<span class="no">degree</span>[<span class="no">i</span>], <span class="no">dt</span>$<span class="no">degree</span>[<span class="no">j</span>])
  }
}
<span class="no">degreemat</span>[<span class="no">degreemat</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">.1</span></pre></body></html></div>
<p>It is also not neccessary to control for activity (outdegree) and popularity (indegree) of different node groups in the standard gHypEG regression. However, if you’d like to test for these effects (because they are part of your hypothesis), the gHypEG regression can be estimated with average expected degrees (i.e., without the degree correction).</p>
<p>For attribute-based outdegree measures, create custom matrices:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">age_activity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">dt</span>$<span class="no">age</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>)),
                                <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">svp_activity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">dt</span>$<span class="no">party</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>)),
                           <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">svp_activity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svp_activity_mat</span> <span class="kw">==</span> <span class="st">'SVP'</span>, <span class="fl">10</span>, <span class="fl">1</span>)</pre></body></html></div>
<p>For attribute-based indegree measures, create custom matrices:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">age_popularity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">dt</span>$<span class="no">age</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>)),
                                <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">svp_popularity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">dt</span>$<span class="no">party</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">cospons_mat</span>)),
                           <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">cospons_mat</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">svp_popularity_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svp_popularity_mat</span> <span class="kw">==</span> <span class="st">'SVP'</span>, <span class="fl">10</span>, <span class="fl">1</span>)</pre></body></html></div>
</div>
</div>
</div>
<div id="part-2-running-ghypeg-regressions" class="section level1">
<h1 class="hasAnchor">
<a href="#part-2-running-ghypeg-regressions" class="anchor"></a>Part 2: Running gHypEG regressions</h1>
<div id="regression-set-up-how-to" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-set-up-how-to" class="anchor"></a>Regression set up (how to)</h2>
<p>The gHypEG regression can be estimated using the <code><a href="../reference/nrm.html">nrm()</a></code>-function. The function takes</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nrm.html">nrm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">cospons_mat</span>, <span class="kw">w</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">reciprocity</span> <span class="kw">=</span> <span class="no">recip_cospons</span>),
           <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">regular</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>The <code>adj</code>-object takes the adjacency matrix of the multi-edge network (i.e., the dependent variable). The <code>w</code>-object (stands for weights) takes the list of covariates. All covariates can be combined into one list. The list can be named for a better overview in the regression output. The <code>directed</code>-argument can either be <code>TRUE</code> or <code>FALSE</code>. If set to <code>TRUE</code>, the multi-edge network under consideration is directed in nature. The <code>selfloops</code>-argument can either be <code>TRUE</code> or <code>FALSE</code>. If set to <code>TRUE</code>, self-loops are considered possible in the network. In the case of co-sponsorship support signatures, self-loops are not possible by definition and should therefore be excluded from the analysis. In the case of a citation network, however, self-loops are possible and meaningful and should be included from the analysis. The <code>regular</code>-argument can either be <code>TRUE</code> or <code>FALSE</code>. If set to <code>TRUE</code>, the gHypEG regression is estimated with estimated average degrees (specified with the <code>xi</code>-matrix) instead of with the automatic control for combinatorial effects.</p>
<div id="what-are-initial-values" class="section level3">
<h3 class="hasAnchor">
<a href="#what-are-initial-values" class="anchor"></a>What are initial values?</h3>
<p>Initial values for the weights can be specified in the gHypEG regression. These initial values help the estimation process to speed up the estimation process even more. Alternatiely, these initial values can be calculated endogenously. The <code>XXTOOD</code>-function can be used for this purpose. It automatically sets the appropriate initial values by going through a stepwise process first.</p>
</div>
</div>
<div id="regression-table-export-using-the-texreg-package" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-table-export-using-the-texreg-package" class="anchor"></a>Regression table export (using the texreg package)</h2>
<p>The <code>texreg</code>-package can be used to export regression tables.</p>
</div>
<div id="regression-with-degree-correction-standard-version" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-with-degree-correction-standard-version" class="anchor"></a>Regression with degree correction (standard version)</h2>
<p>Co-sponsorship networks have been shown to be structured by reciprocity <span class="citation">[@cranmer2011inferential]</span>. Several empirical studies have shown that co-sponsorship networks also exhibit tendencies towards triadic closure <span class="citation">[@tam2010legislative]</span>. However, Brandenberger <span class="citation">[-@brandenberger2018trading]</span> shows that when estimating co-sponsorship networks as bipartite graphs, the triadic closure effect is non-existant. <span class="citation">@craig2015role</span> show that homophily also plays an important role in co-sponsorship networks. We therefore use these predictors to estimate the effect of MPs supporting each other’s bills in parliament.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">nfit1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nrm.html">nrm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">cospons_mat</span>,
                      <span class="kw">w</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">same_canton</span> <span class="kw">=</span> <span class="no">canton_homophilymat</span>),
                      <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">nfit1</span>)
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; nrm.default(w = list(same_canton = canton_homophilymat), adj = cospons_mat, </span>
<span class="co">#&gt;     directed = TRUE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate   Std.Err t value    Pr(&gt;t)    </span>
<span class="co">#&gt; same_canton 0.0906922 0.0066777  13.581 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R2:</span>
<span class="co">#&gt;  McFadden R2 Cox Snell R2 </span>
<span class="co">#&gt; -0.005797166  0.006735985</span></pre></body></html></div>
<p>To speed things up, the <code>init</code>-argument can be specified:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">nfit1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nrm.html">nrm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">cospons_mat</span>,
                      <span class="kw">w</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">same_canton</span> <span class="kw">=</span> <span class="no">canton_homophilymat</span>),
                      <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                      <span class="kw">init</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.09</span>))
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">nfit1</span>)
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; nrm.default(w = list(same_canton = canton_homophilymat), adj = cospons_mat, </span>
<span class="co">#&gt;     directed = TRUE, init = c(0.09))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate   Std.Err t value    Pr(&gt;t)    </span>
<span class="co">#&gt; same_canton 0.0906920 0.0066777  13.581 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R2:</span>
<span class="co">#&gt;  McFadden R2 Cox Snell R2 </span>
<span class="co">#&gt; -0.005797170  0.006735966</span></pre></body></html></div>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="kw pkg">texreg</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/texreg/man/screenreg.html">screenreg</a></span>(<span class="no">nfit1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ============================</span>
<span class="co">#&gt;                 Model 1     </span>
<span class="co">#&gt; ----------------------------</span>
<span class="co">#&gt; same_canton         0.09 ***</span>
<span class="co">#&gt;                    (0.01)   </span>
<span class="co">#&gt; ----------------------------</span>
<span class="co">#&gt; AIC             82323.77    </span>
<span class="co">#&gt; McFadden $R^2$     -0.01    </span>
<span class="co">#&gt; ============================</span>
<span class="co">#&gt; *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></pre></body></html></div>
<p>The variable <code>same_canton</code> shows a positive coefficient and is significant. The coefficient of <span class="math inline">\(0.09\)</span> can be interpreted as follows: The odds of MP <span class="math inline">\(i\)</span> co-sponsoring the bill of MP <span class="math inline">\(j\)</span> increase by a factor of <span class="math inline">\(1.23\)</span> (<span class="math inline">\((10^{0.09})/(1^{0.09}) = 1.23\)</span>) if <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are representatives from the same canton. Since the baseline of the dummy covariate <code>same_canton</code> is 1, the odds can be calculated by exponating the coefficient over the treatment value (here 10).</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">nfit2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nrm.html">nrm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">cospons_mat</span>,
             <span class="kw">w</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">reciprocity</span> <span class="kw">=</span> <span class="no">recip_cospons</span>,
                      <span class="co">#sharedpartner_in = shp_cospons_incoming,</span>
                      <span class="co">#sharedpartner_out = shp_cospons_outgoing, </span>
                      <span class="kw">party</span> <span class="kw">=</span> <span class="no">party_homophilymat</span>,
                      <span class="kw">canton</span> <span class="kw">=</span> <span class="no">canton_homophilymat</span>,
                      <span class="kw">gender</span> <span class="kw">=</span> <span class="no">gender_homophilymat</span>,
                      <span class="kw">age</span> <span class="kw">=</span> <span class="no">age_absdiffmat</span>,
                      <span class="kw">committee</span> <span class="kw">=</span> <span class="no">shared_committee</span>,
                      <span class="kw">online_similarity</span> <span class="kw">=</span> <span class="no">onlinesim_mat</span> ),
             <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
             <span class="kw">init</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.1</span>, <span class="fl">.5</span>, <span class="fl">.1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))</pre></body></html></div>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/texreg/man/screenreg.html">screenreg</a></span>(<span class="no">nfit2</span>,
          <span class="kw">groups</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'Endogenous'</span> <span class="kw">=</span> <span class="fl">1</span>,
                     <span class="st">'Homophily'</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>:<span class="fl">5</span>),
                     <span class="st">'Exogenous'</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>:<span class="fl">7</span>)))
<span class="co">#&gt; </span>
<span class="co">#&gt; ===================================</span>
<span class="co">#&gt;                        Model 1     </span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt; Endogenous                         </span>
<span class="co">#&gt;                                    </span>
<span class="co">#&gt;     reciprocity            0.22 ***</span>
<span class="co">#&gt;                           (0.00)   </span>
<span class="co">#&gt; Homophily                          </span>
<span class="co">#&gt;                                    </span>
<span class="co">#&gt;     party                  0.54 ***</span>
<span class="co">#&gt;                           (0.01)   </span>
<span class="co">#&gt;     canton                 0.10 ***</span>
<span class="co">#&gt;                           (0.01)   </span>
<span class="co">#&gt;     gender                 0.08 ***</span>
<span class="co">#&gt;                           (0.01)   </span>
<span class="co">#&gt;     age                   -0.04 ***</span>
<span class="co">#&gt;                           (0.01)   </span>
<span class="co">#&gt; Exogenous                          </span>
<span class="co">#&gt;                                    </span>
<span class="co">#&gt;     committee              0.02 ***</span>
<span class="co">#&gt;                           (0.01)   </span>
<span class="co">#&gt;     online_similarity      0.03 ***</span>
<span class="co">#&gt;                           (0.00)   </span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt; AIC                    55374.64    </span>
<span class="co">#&gt; McFadden $R^2$             0.32    </span>
<span class="co">#&gt; ===================================</span>
<span class="co">#&gt; *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></pre></body></html></div>
<p>XXTODO: add the find-init version here. Add the triad-function. Then interpret some coefficients.</p>
</div>
<div id="regression-without-degree-correction-and-when-to-use-it" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-without-degree-correction-and-when-to-use-it" class="anchor"></a>Regression without degree correction (and when to use it)</h2>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">nfit3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nrm.html">nrm</a></span>(<span class="kw">adj</span> <span class="kw">=</span> <span class="no">cospons_mat</span>,
              <span class="kw">w</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">degree</span> <span class="kw">=</span> <span class="no">degreemat</span>,
                       <span class="kw">reciprocity</span> <span class="kw">=</span> <span class="no">recip_cospons</span>,
                       <span class="co">#sharedpartner_in = shp_cospons_incoming,</span>
                       <span class="co">#sharedpartner_out = shp_cospons_outgoing, </span>
                       <span class="kw">party</span> <span class="kw">=</span> <span class="no">party_homophilymat</span>,
                       <span class="kw">svp_in</span> <span class="kw">=</span> <span class="no">svp_popularity_mat</span>,
                       <span class="kw">svp_out</span> <span class="kw">=</span> <span class="no">svp_activity_mat</span>,
                       <span class="kw">canton</span> <span class="kw">=</span> <span class="no">canton_homophilymat</span>,
                       <span class="kw">gender</span> <span class="kw">=</span> <span class="no">gender_homophilymat</span>,
                       <span class="kw">age</span> <span class="kw">=</span> <span class="no">age_absdiffmat</span>,
                       <span class="kw">agein</span> <span class="kw">=</span> <span class="no">age_popularity_mat</span>,
                       <span class="kw">ageout</span> <span class="kw">=</span> <span class="no">age_activity_mat</span>,
                       <span class="kw">committee</span> <span class="kw">=</span> <span class="no">shared_committee</span>,
                       <span class="kw">online_similarity</span> <span class="kw">=</span> <span class="no">onlinesim_mat</span>),
              <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">regular</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
              <span class="kw">init</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.1</span>, <span class="fl">.01</span>))
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">nfit3</span>)
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; nrm.default(w = list(degree = degreemat, reciprocity = recip_cospons, </span>
<span class="co">#&gt;     party = party_homophilymat, svp_in = svp_popularity_mat, </span>
<span class="co">#&gt;     svp_out = svp_activity_mat, canton = canton_homophilymat, </span>
<span class="co">#&gt;     gender = gender_homophilymat, age = age_absdiffmat, agein = age_popularity_mat, </span>
<span class="co">#&gt;     ageout = age_activity_mat, committee = shared_committee, </span>
<span class="co">#&gt;     online_similarity = onlinesim_mat), adj = cospons_mat, directed = TRUE, </span>
<span class="co">#&gt;     regular = TRUE, init = c(0, 0.1, 0.5, 0, 0, 0.1, 0, 0, 0, </span>
<span class="co">#&gt;         0, 0.1, 0.01))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                     Estimate    Std.Err t value    Pr(&gt;t)    </span>
<span class="co">#&gt; degree             0.9499893  0.0149912 63.3699 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; reciprocity        0.3604926  0.0049628 72.6390 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; party              0.4616187  0.0085039 54.2829 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; svp_in            -0.0902519  0.0094819  9.5184 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; svp_out            0.0797266  0.0090761  8.7842 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; canton             0.0740158  0.0067500 10.9653 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; gender             0.0435733  0.0055052  7.9150 2.473e-15 ***</span>
<span class="co">#&gt; age               -0.0372427  0.0051828  7.1859 6.677e-13 ***</span>
<span class="co">#&gt; agein              0.4135894  0.0363335 11.3832 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ageout             0.0680494  0.0361741  1.8812   0.05995 .  </span>
<span class="co">#&gt; committee          0.0610871  0.0051097 11.9551 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; online_similarity  0.0842512  0.0044993 18.7252 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R2:</span>
<span class="co">#&gt;  McFadden R2 Cox Snell R2 </span>
<span class="co">#&gt;    0.5018393    0.8956821</span></pre></body></html></div>
<p>Comparing the two models:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/texreg/man/screenreg.html">screenreg</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">nfit2</span>, <span class="no">nfit3</span>),
          <span class="kw">custom.model.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'with degree correction'</span>, <span class="st">'without deg. cor.'</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; ============================================================</span>
<span class="co">#&gt;                    with degree correction  without deg. cor.</span>
<span class="co">#&gt; ------------------------------------------------------------</span>
<span class="co">#&gt; reciprocity            0.22 ***                0.36 ***     </span>
<span class="co">#&gt;                       (0.00)                  (0.00)        </span>
<span class="co">#&gt; party                  0.54 ***                0.46 ***     </span>
<span class="co">#&gt;                       (0.01)                  (0.01)        </span>
<span class="co">#&gt; canton                 0.10 ***                0.07 ***     </span>
<span class="co">#&gt;                       (0.01)                  (0.01)        </span>
<span class="co">#&gt; gender                 0.08 ***                0.04 ***     </span>
<span class="co">#&gt;                       (0.01)                  (0.01)        </span>
<span class="co">#&gt; age                   -0.04 ***               -0.04 ***     </span>
<span class="co">#&gt;                       (0.01)                  (0.01)        </span>
<span class="co">#&gt; committee              0.02 ***                0.06 ***     </span>
<span class="co">#&gt;                       (0.01)                  (0.01)        </span>
<span class="co">#&gt; online_similarity      0.03 ***                0.08 ***     </span>
<span class="co">#&gt;                       (0.00)                  (0.00)        </span>
<span class="co">#&gt; degree                                         0.95 ***     </span>
<span class="co">#&gt;                                               (0.01)        </span>
<span class="co">#&gt; svp_in                                        -0.09 ***     </span>
<span class="co">#&gt;                                               (0.01)        </span>
<span class="co">#&gt; svp_out                                        0.08 ***     </span>
<span class="co">#&gt;                                               (0.01)        </span>
<span class="co">#&gt; agein                                          0.41 ***     </span>
<span class="co">#&gt;                                               (0.04)        </span>
<span class="co">#&gt; ageout                                         0.07         </span>
<span class="co">#&gt;                                               (0.04)        </span>
<span class="co">#&gt; ------------------------------------------------------------</span>
<span class="co">#&gt; AIC                55374.64                59565.77         </span>
<span class="co">#&gt; McFadden $R^2$         0.32                    0.50         </span>
<span class="co">#&gt; ============================================================</span>
<span class="co">#&gt; *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></pre></body></html></div>
</div>
</div>
<div id="part-3-model-assessment-network-simulations-gof" class="section level1">
<h1 class="hasAnchor">
<a href="#part-3-model-assessment-network-simulations-gof" class="anchor"></a>Part 3: Model assessment, network simulations, gof</h1>
<div id="model-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#model-comparisons" class="anchor"></a>Model comparisons</h2>
<p>Model comparisons can be done using <code>AIC</code>-scores, LR-tests or the R-squared measures. AIC-scores are the best indicators of model fit. The gHypEG model can also be fit maximally to the data. This perfectly fit model cannot be interpreted (since step by step, additional predictive layers are added and these laysers capture deviances but would need to be interpreted individually), but the AIC scores can be used to check how far away your models are from it.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">fullfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ghype.html">ghype</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">cospons_mat</span>, <span class="kw">directed</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">selfloops</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
</div>
<div id="predicted-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#predicted-probabilities" class="anchor"></a>Predicted probabilities</h2>
<p>The omega matrix stored in the <code>nrm</code>-object holds XXTODO. It can be used to calculate marginal effects.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">nfit2omega</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">omega</span> <span class="kw">=</span> <span class="no">nfit2</span>$<span class="no">omega</span>,
                         <span class="kw">cosponsfull</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">cospons_mat</span>),
                         <span class="kw">age_absdiff</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">age_absdiffmat</span>),
                         <span class="kw">sameparty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">party_homophilymat</span>))
<span class="no">nfit2omega</span>[<span class="no">nfit2omega</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">nfit2omega</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(<span class="no">nfit2omega</span>)</pre></body></html></div>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">nfit2omega</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">age_absdiff</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">omega</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sameparty</span>)))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.1</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>() + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">'bottom'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="st">""</span>, <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'#E41A1C'</span>, <span class="st">'#377EB8'</span>), <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Between parties'</span>, <span class="st">'Within party'</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Age difference"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Tie propensities"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">'Model (2): Marginal effects of age difference'</span>)
<span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></pre></body></html></div>
<p><img src="Tutorial_NRM_files/figure-html/unnamed-chunk-36-1.png" width="672"></p>
</div>
<div id="network-simulations" class="section level2">
<h2 class="hasAnchor">
<a href="#network-simulations" class="anchor"></a>Network simulations</h2>
<p>The <code><a href="../reference/rghype.html">rghype()</a></code>-function simulates networks form <code>nrm</code>-models. The number of simulations can be specified with the <code>nsamples</code> argument.</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">simnw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rghype.html">rghype</a></span>(<span class="kw">nsamples</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">nfit2</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1253</span>)</pre></body></html></div>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(<span class="kw">graph</span> <span class="kw">=</span> <span class="no">simnw</span>, <span class="kw">layout</span> <span class="kw">=</span> <span class="st">'stress'</span>) +
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">filter</span> <span class="kw">=</span> <span class="no">weight</span><span class="kw">&gt;</span><span class="fl">5</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="no">weight</span>)) +
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="no">dt</span>$<span class="no">parlGroup</span>), <span class="kw">size</span><span class="kw">=</span><span class="fl">10</span>*<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">simnw</span>,<span class="fl">1</span>,<span class="no">sum</span>)/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">simnw</span>,<span class="fl">1</span>,<span class="no">sum</span>))) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span>(<span class="st">""</span>, <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'orange'</span>, <span class="st">'yellow'</span>, <span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'grey'</span>,
                                    <span class="st">'darkblue'</span>, <span class="st">'red'</span>, <span class="st">'darkgreen'</span>, <span class="st">'purple'</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">'bottom'</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() + <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html">theme_graph</a></span>()</pre></body></html></div>
<p><img src="Tutorial_NRM_files/figure-html/unnamed-chunk-38-1.png" width="480"></p>
</div>
<div id="goodness-of-fit-measures" class="section level2">
<h2 class="hasAnchor">
<a href="#goodness-of-fit-measures" class="anchor"></a>Goodness of fit measures</h2>
<p>One potential way of performing goodness of fit measures for inferential network models is to simulate new networks based on the regression model and compare structural properties of the simulated networks to the original network <span class="citation">[@hunter2008goodness]</span>. We are currently working on finding appropriate multi-edge network statistics to assess model fit for gHypEGs. We are also looking into alternative ways of assessing network model fit. Stay tuned!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giona Casiraghi, Vahan Nanumyan, Laurence Brandenberger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
